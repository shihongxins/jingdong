{"version":3,"sources":["webpack:///./src/components/Toast.vue","webpack:///./src/components/Toast.vue?d444","webpack:///./src/views/search/components/SearchResult.vue?a521","webpack:///./src/views/search/components/SearchResult.vue","webpack:///./src/views/search/components/SearchResult.vue?7381","webpack:///./src/components/Toast.vue?7de6"],"names":["class","data","content","length","time","showToast","c","t","Toast","name","setup","value","setTimeout","render","__scopeId","handleStatusChange","shops","shop","key","_id","handleResultItemClick","item","products","product","index","src","imgUrl","alt","price","oldPrice","props","keywords","searchText","getSearchResultByKeywords","result","errno","message","router","shopId","push","params","default","components","SearchInput","ShopInfo"],"mappings":"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","file":"js/chunk-4ffe69e4.a4185493.js","sourcesContent":["<template>\n  <div v-if=\"data.content.length\" class=\"toast\">\n    {{data.content}}\n  </div>\n</template>\n\n<script>\nimport { reactive, toRefs, watch } from 'vue'\n\n// toast data\nconst data = reactive({\n  content: '',\n  time: 3000\n})\n\n// show toast function\nconst showToast = (c, t) => {\n  if (c.length) {\n    if (t > 500) {\n      data.time = t\n    }\n    data.content = c\n  }\n}\n\n// Toast component by Vue Composition API\nconst Toast = {\n  name: 'Toast',\n  setup () {\n    // auto hide toast\n    const { content } = toRefs(data)\n    watch(content, (value) => {\n      if (value.length > 0) {\n        setTimeout(() => {\n          data.content = ''\n          data.time = 3000\n        }, data.time)\n      }\n    })\n    return {\n      data\n    }\n  }\n}\n\nexport { Toast as default, showToast }\n</script>\n\n<style lang=\"scss\" scoped>\n.toast {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  border-radius: .05rem;\n  padding: .1rem;\n  color: #fff;\n  background: rgba(0, 0, 0, 0.4);\n}\n</style>\n","import { render } from \"./Toast.vue?vue&type=template&id=3350b2b6&scoped=true\"\nimport script from \"./Toast.vue?vue&type=script&lang=js\"\nexport * from \"./Toast.vue?vue&type=script&lang=js\"\n\nimport \"./Toast.vue?vue&type=style&index=0&id=3350b2b6&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-3350b2b6\"\n\nexport default script","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SearchResult.vue?vue&type=style&index=0&id=0225a130&lang=scss&scoped=true\"","<template>\n  <div class=\"search__result\">\n    <div class=\"search__area\">\n      <div\n        class=\"search__back__btn\"\n        @click=\"handleStatusChange('none')\">\n        <i class=\"iconfont icon-back\"></i>\n      </div>\n      <div class=\"search__input__wrapper\">\n        <SearchInput\n          @onStatusChange=\"handleStatusChange\" />\n      </div>\n    </div>\n    <div class=\"search__result__container\">\n      <div\n        class=\"search__result__item\"\n        v-for=\"shop in shops\"\n        :key=\"shop._id\"\n        @click=\"handleResultItemClick(shop._id)\">\n        <ShopInfo :item=\"shop\" />\n        <div class=\"shopinfo__products\">\n          <!-- 只展示前三个故使用 template -->\n          <template\n            v-for=\"(product, index) in shop.products\"\n            :key=\"index\">\n            <div\n              class=\"products__item\"\n              v-if=\"index<3\">\n              <img\n                class=\"products__item__img\"\n                :src=\"product.imgUrl\"\n                :alt=\"product.name\">\n              <h4 class=\"products__item__name\">{{product.name}}</h4>\n              <p class=\"products__item__price\">\n                <small>￥</small>{{product.price}}\n                <small class=\"origin\">￥{{product.oldPrice}}</small>\n              </p>\n            </div>\n          </template>\n        </div>\n      </div>\n    </div>\n  </div>\n  <Toast />\n</template>\n\n<script>\nimport SearchInput from './SearchInput'\nimport ShopInfo from '../../../components/ShopInfo'\nimport Toast, { showToast } from '../../../components/Toast'\nimport { get } from '../../../utils/request'\nimport { inject, reactive, ref, toRefs } from 'vue'\nimport { useRouter } from 'vue-router'\n\nconst useSearchResultEffect = (props) => {\n  // 搜索关键字返回结果\n  const keywords = props.searchText.value\n  const data = reactive({ shops: [] })\n  const getSearchResultByKeywords = async () => {\n    try {\n      const result = await get('/api/shop/search', { keywords })\n      if (result && result.errno === 0) {\n        data.shops = result.data\n      } else {\n        showToast(`搜索店铺关键字失败！${result.message}`)\n      }\n    } catch (e) {\n      showToast(`搜索店铺关键字出错！${e.message}`)\n    }\n  }\n  getSearchResultByKeywords()\n  const { shops } = toRefs(data)\n  // 点击搜索结果项目，跳转到具体商店\n  const router = useRouter()\n  const handleResultItemClick = (shopId) => {\n    // 跳转前关闭搜索结果\n    props.handleStatusChange('none')\n    router.push({ name: 'Shop', params: shopId })\n  }\n  return { shops, handleResultItemClick }\n}\n\nexport default {\n  name: 'SearchResult',\n  props: {\n    searchText: {\n      default: () => {\n        return inject('searchText', ref(''))\n      }\n    },\n    handleStatusChange: {\n      default: () => {\n        return inject('handleStatusChange')\n      }\n    }\n  },\n  components: {\n    SearchInput,\n    ShopInfo,\n    Toast\n  },\n  setup (props) {\n    const { shops, handleResultItemClick } = useSearchResultEffect(props)\n    return { shops, handleResultItemClick }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../../assets/style/variables.scss';\n@import '../../../assets/style/mixins.scss';\n\n.search__result {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 3;\n  padding: .16rem .18rem;\n  background: #fff;\n  .search__area {\n    display: flex;\n    .search__input__wrapper {\n      flex: 1;\n    }\n    .search__back__btn {\n      width: .3rem;\n      height: .32rem;\n      line-height: .32rem;\n      text-align: center;\n      .iconfont {\n        font-size: .2rem;\n        color: $btn-back-bgcolor;\n      }\n    }\n  }\n  &__container {\n    padding: .12rem 0;\n    // 深度作用选择器，修改公共组件 ShopInfo 的样式\n    .search__result__item :deep(.shopinfo__content) {\n      border: none;\n      padding: 0;\n    }\n    .shopinfo__products {\n      padding: 0.08rem 0 0.12rem 0;\n      margin-left: .72rem;\n      border-bottom: .01rem solid $content-bgcolor; // TODO: 1px border\n      overflow: hidden;\n      display: flex;\n      flex-flow: row nowrap;\n      .products__item {\n        padding-right: .16rem;\n        width: .76rem;\n        &__img {\n          width: .76rem;\n          height: .76rem;\n        }\n        &__name {\n          margin: 0;\n          line-height: .16rem;\n          font-size: .12rem;\n          color: $content-fontcolor;\n          @include ellipsis;\n        }\n        &__price {\n          margin: 0;\n          line-height: .14rem;\n          font-size: .14rem;\n          color: $highlight-fontcolor;\n          display: flex;\n          justify-content: space-between;\n          .origin {\n            font-size: .2rem;\n            color: $light-fontcolor;\n            text-decoration: line-through;\n            transform: scale(.5);\n            transform-origin: left center;\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","import { render } from \"./SearchResult.vue?vue&type=template&id=0225a130&scoped=true\"\nimport script from \"./SearchResult.vue?vue&type=script&lang=js\"\nexport * from \"./SearchResult.vue?vue&type=script&lang=js\"\n\nimport \"./SearchResult.vue?vue&type=style&index=0&id=0225a130&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-0225a130\"\n\nexport default script","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Toast.vue?vue&type=style&index=0&id=3350b2b6&lang=scss&scoped=true\""],"sourceRoot":""}